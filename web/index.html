<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="index.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tá»« Äiá»ƒn Trie Tree</title>
</head>
<body>

    <h2>Web Tá»« Äiá»ƒn (Trie Tree) ğŸš€</h2>

    <div class="search-container">
        <input type="text" id="searchInput" placeholder="Nháº­p tá»« cáº§n tÃ¬m..." oninput="getSuggestions()" autocomplete="off">
        <button onclick="searchWord()">TÃ¬m kiáº¿m</button>
        <ul id="suggestionsList"></ul>
    </div>

    <div id="result"></div>

    <div class="options">
        <div class="option">PhÃ¡t Ã¢m</div>
        <div class="option" onclick="startGame()">Gaming</div>
        <div id="gameModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeGameModal()">&times;</span>
                <h2 style="color: black;">ğŸ•¹ï¸ TrÃ² chÆ¡i Ä‘oÃ¡n tá»«</h2>
                <p id="gameQuestion"></p>
                <input type="text" id="gameAnswer" placeholder="Nháº­p tá»« tiáº¿ng Anh..." />
                <button onclick="submitGameAnswer()" style="background: #007BFF; color: white;">Tráº£ lá»i</button>
                <button onclick="closeGameModal()" style="background: gray; color: white;">ÄÃ³ng</button>
                <div id="gameFeedback"></div> <!-- ThÃªm chá»— hiá»ƒn thá»‹ káº¿t quáº£ -->
            </div>
        </div>
        
        <div class="option">Test</div>
    </div>

    <script>
        async function searchWord() {
            let word = document.getElementById("searchInput").value.trim();
            if (!word) {
                alert("Vui lÃ²ng nháº­p tá»« cáº§n tÃ¬m!");
                return;
            }

            try {
                let response = await fetch(`/search?word=${encodeURIComponent(word)}`);
                let data = await response.json();

                let resultDiv = document.getElementById("result");
                if (!data.exists) {
                    resultDiv.innerHTML = `<p style="color:red;">âŒ ${data.message}</p>`;
                } else {
                    resultDiv.innerHTML = `
                        <h3>Káº¿t quáº£ tÃ¬m kiáº¿m:</h3>
                        <p><b>Tá»«:</b> ${data.data.word}</p>
                        <p><b>PhiÃªn Ã¢m:</b> ${data.data.phonetic}</p>
                        <p><b>Loáº¡i tá»«:</b> ${data.data.types.join(", ")}</p>
                        <p><b>Äá»‹nh nghÄ©a:</b> ${data.data.meanings.join("; ")}</p>
                        <p><b>VÃ­ dá»¥:</b> ${data.data.examples.join("; ")}</p>
                    `;
                }
            } catch (error) {
                console.error("Lá»—i khi tÃ¬m kiáº¿m:", error);
            }
        }

        async function getSuggestions() {
            const prefix = document.getElementById("searchInput").value.trim();
            const suggestionsList = document.getElementById("suggestionsList");

            if (prefix.length === 0) {
                suggestionsList.style.display = "none";
                return;
            }

            const response = await fetch(`/autocomplete?prefix=${prefix}`);
            const data = await response.json();

            if (data.suggestions.length === 0) {
                suggestionsList.style.display = "none";
                return;
            }

            let listHTML = "";
            data.suggestions.forEach(word => {
                listHTML += `<li onclick="selectWord('${word}')">${word}</li>`;
            });

            suggestionsList.innerHTML = listHTML;
            suggestionsList.style.display = "block";
        }

        function selectWord(word) {
            document.getElementById("searchInput").value = word;
            document.getElementById("suggestionsList").style.display = "none";
        }
        let correctAnswer = ""; // Biáº¿n lÆ°u trá»¯ Ä‘Ã¡p Ã¡n Ä‘Ãºng

// Hiá»ƒn thá»‹ modal trÃ² chÆ¡i
async function startGame() {
    try {
        let response = await fetch('/game-word');
        let data = await response.json();

        if (!data.word || !data.meaning) {
            alert("Lá»—i láº¥y dá»¯ liá»‡u trÃ² chÆ¡i!");
            return;
        }

        correctAnswer = data.word.toLowerCase(); // LÆ°u Ä‘Ã¡p Ã¡n
        document.getElementById("gameQuestion").innerHTML = `ğŸ”¹ NghÄ©a tiáº¿ng Viá»‡t: <b>${data.meaning}</b>`;
        document.getElementById("gameModal").style.display = "flex";
    } catch (error) {
        console.error("Lá»—i khi táº£i trÃ² chÆ¡i:", error);
    }
}

// Kiá»ƒm tra Ä‘Ã¡p Ã¡n
function submitGameAnswer() {
    let userAnswer = document.getElementById("gameAnswer").value.trim().toLowerCase();
    let feedbackDiv = document.getElementById("gameFeedback"); // ThÃªm div Ä‘á»ƒ hiá»ƒn thá»‹ káº¿t quáº£

    if (userAnswer === correctAnswer) {
        feedbackDiv.innerHTML = `<p style="color: green;">âœ… ChÃ­nh xÃ¡c! Báº¡n giá»i quÃ¡!</p>`;
    } else {
        feedbackDiv.innerHTML = `<p style="color: red;">âŒ Sai rá»“i! ÄÃ¡p Ã¡n Ä‘Ãºng lÃ : <b>${correctAnswer}</b></p>`;
    }
}

// ÄÃ³ng modal
function closeGameModal() {
    document.getElementById("gameModal").style.display = "none";
}

        document.querySelector(".option:nth-child(2)").addEventListener("click", startGame);

        document.addEventListener("click", function(event) {
            if (!event.target.matches("#searchInput") && !event.target.matches("#suggestionsList li")) {
                document.getElementById("suggestionsList").style.display = "none";
            }
        });
    </script>

</body>
</html>




